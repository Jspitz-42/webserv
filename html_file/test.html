<!doctype html>
<html lang="en">
	<head>
	  <meta charset="utf-8" />
	  <meta name="viewport" content="width=device-width, initial-scale=1" />
	  <title>webserv</title>
	</head>
	<style>
		button, label.upload-btn {
			padding: 20px 40px;
			font-size: 1.4rem;
			color: #0ff;
			background:  linear-gradient(145deg, #32cd32, #1e90ff);
			border: none;
			border-radius: 20px;
			cursor: pointer;
			box-shadow: 0 0 20px #32cd32;
			transition: all 0.5s ease;
			user-select: none;
		}
		body {
			text-align: center;
			background-color: rgb(0, 0, 0);
		}
		h1 {
			text-align: center;
			color: red;
		}
		h2 {
			text-align: center;
			color: blueviolet;
		}
		p {
			text-align: center;
		}
		img {
			border: 3px solid palevioletred;
		}
		.aurora-glow-button {
			padding: 20px 40px;
			font-size: 1.4rem;
			color: #0ff;
			background:  linear-gradient(145deg, #32cd32, #1e90ff);
			border: none;
			border-radius: 20px;
			cursor: pointer;
			box-shadow: 0 0 20px #32cd32;
			transition: all 0.5s ease;

		}
		.aurora-glow-button:hover {
			background: linear-gradient(145deg, #ff4500, #ff00ff);
			box-shadow: 0 0 50px #ff4500, 0 0 80px #ff00ff;
			transform: scale(1.1);
			color: #000;
			font-weight: 700;
			font-style: oblique;
		}
		.aurora-glow-button:active {
			box-shadow: 0 0 40px rgba(255, 69, 0,0.8);
		}
		aside {
			padding-left: 30px;
		}
		.container {
			display: grid;
			gap: 50px;
			grid-template-columns: auto auto;
			padding: 10px;
		}
		label.upload-btn {
			display: inline-block;
		}
		.container > div {
			padding: 20px;
			font-size: 30px;
			text-align: center;
		}
		#file-name {
			margin-top: 8px;
			color: #555;
			font-style: italic;
			width: 100%;
			text-align: center;
		}
		input[type="file"] {
			display: none;
		}
		.session-id {
			position: fixed;
			top: 80%;
			left: 50%;
			transform: translate(-50%, -50%);
			color: #0ff;
			font-size: 2rem;
			background: rgba(0, 0, 0, 0.6);
			padding: 20px 40px;
			border-radius: 15px;
			box-shadow: 0 0 15px #1e90ff;
		}
	</style>
	<script>
		function getCookie(name) {
			const value = `; ${document.cookie}`;
			const parts = value.split(`; ${name}=`);
			if (parts.length === 2) return parts.pop().split(';').shift();
			return null;
		}

		window.onload = () => {
			const sessionId = getCookie('id_session');
			console.log(getCookie("id_session"))
			const sessionSpan = document.getElementById('session-id');
			if (sessionId) {
				sessionSpan.textContent = 'ID-Session : ' + sessionId;
			} else {
				sessionSpan.textContent = 'ID-Session : Not found';
			}
		};
	</script>

<body>
    <h1>Webserv</h1>
	<p2 id ="demo"></p2>
	<div class="container">
	
		<div>
		
			<form action="/upload" method="POST" enctype="multipart/form-data">
				<label for="file" class="upload-btn">Chose a file</label>
				<input type="file" name="file" id="file" required />
				</div>
		
				<div>
				<button class="aurora-glow-button"
				type="submit"> Send </button>
			</form>
		</div>


		<div>
		    <form action="cgi/python.py" method="POST">
		        <button class="aurora-glow-button" type="submit">python CGI</button>
		    </form>
		</div>

		<div>
			<form action="cgi/javascript.js" method="POST">
				<button class="aurora-glow-button" type="submit">javascript CGI</button>
			</form>
		</div>

		<div>
			<form action="cgi/cgi.php" method="POST">
				<button class="aurora-glow-button" type="submit">php CGI</button>
			</form>
		</div>
		<div>
			<form action="/redirect" method="GET">
		        <button class="aurora-glow-button" type="submit">Redirect</button>
		    </form>
		</div>
		<div>
			<form action="cgi/upload.py" method="POST" enctype="multipart/form-data">
				<label for="cgi-file" class="upload-btn">Choose file for CGI</label>
				<input type="file" name="file" id="cgi-file" required />
				<button class="aurora-glow-button" type="submit">Upload CGI</button>
			</form>
		</div>
		<div>
  			<form id="delete-form" onsubmit="sendDelete(event)">
  			  <label for="delete-file">Nom du fichier Ãƒ  supprimer :</label>
  			  <input type="text" name="deleteFiles" id="delete-file" placeholder="ex: test.py" required />
  			  <button class="aurora-glow-button" type="submit">Supprimer</button>
  			</form>
		</div>
	</div>
		<span id="session-id" class="session-id">ID-Session : inconnue</span>

</body>
<script>
  function sendDelete(event) {
    event.preventDefault();

    const form = document.getElementById('delete-form');
    const formData = new FormData(form);

    fetch('/delete', {
      method: 'DELETE',
      body: formData
    })
    .then(response => {
      if (response.ok) {
        alert("Files deleted successfully.");
      } else {
        alert("Failed to delete files.");
      }
    })
    .catch(error => {
      console.error("Error:", error);
      alert("An error occurred while deleting files.");
    });
  }
</script>
</html>
<!--
	1 : 6 boutons : un qui lance l'upload, 1 pour choisir les fichiers, 1 pour getCgi,
					un pour redir, un pour upload cgi, un pour acceder au directory listing
					
					un over aurora pour les bouttons, un fond en mode pop art avec des boules qui bouge
					-->